<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 520" width="100%" role="img" aria-label="PicoPics architecture diagram">
  <!-- Top row: Frontend -->
  <g transform="translate(40,20)">
    <rect width="260" height="80" fill="#e6f0ff" stroke="#222" stroke-width="1" rx="10" ry="10"/>
    <text x="18" y="32" font-family="Arial, Inter, sans-serif" font-size="18" font-weight="bold" fill="#0f172a">Next.js Frontend</text>
    <text x="18" y="52" font-family="Arial, Inter, sans-serif" font-size="12" fill="#334155">User interface — upload, browse, manage</text>
  </g>

  <!-- Uploader Worker -->
  <g transform="translate(380,20)">
    <rect width="260" height="100" fill="#e9e7ff" stroke="#222" stroke-width="1" rx="10" ry="10"/>
    <text x="18" y="32" font-family="Arial, Inter, sans-serif" font-size="18" font-weight="bold" fill="#0f172a">Uploader Worker</text>
    <text x="18" y="52" font-family="Arial, Inter, sans-serif" font-size="12" fill="#334155">Authentication • Pre-checks • Chunked upload</text>
    <text x="18" y="70" font-family="Arial, Inter, sans-serif" font-size="12" fill="#334155">Triggers AI moderation and storage write</text>
  </g>

  <!-- AI & Quota -->
  <g transform="translate(720,20)">
    <rect width="240" height="120" fill="#fff7ed" stroke="#222" stroke-width="1" rx="10" ry="10"/>
    <text x="18" y="32" font-family="Arial, Inter, sans-serif" font-size="18" font-weight="bold" fill="#0f172a">Cloudflare AI</text>
    <text x="18" y="52" font-family="Arial, Inter, sans-serif" font-size="12" fill="#334155">Image analysis & moderation</text>
    <rect x="18" y="62" width="204" height="1" fill="#e6e7eb" />
    <text x="18" y="86" font-family="Arial, Inter, sans-serif" font-size="13" font-weight="bold" fill="#0f172a">Durable Objects</text>
    <text x="18" y="102" font-family="Arial, Inter, sans-serif" font-size="12" fill="#334155">Quota, rate limit & abuse state</text>
  </g>

  <!-- Storage (R2) center -->
  <g transform="translate(360,180)">
    <rect width="280" height="110" fill="#fff0d6" stroke="#222" stroke-width="1" rx="10" ry="10"/>
    <text x="20" y="44" font-family="Arial, Inter, sans-serif" font-size="18" font-weight="bold" fill="#0f172a">R2 Storage</text>
    <text x="20" y="66" font-family="Arial, Inter, sans-serif" font-size="12" fill="#334155">Objects: original, optimized, thumbnails</text>
    <text x="20" y="86" font-family="Arial, Inter, sans-serif" font-size="12" fill="#334155">HTTP metadata and lifecycle rules</text>
  </g>

  <!-- Delivery Worker -->
  <g transform="translate(40,340)">
    <rect width="260" height="100" fill="#e6fff5" stroke="#222" stroke-width="1" rx="10" ry="10"/>
    <text x="18" y="34" font-family="Arial, Inter, sans-serif" font-size="18" font-weight="bold" fill="#0f172a">CDN Delivery Worker</text>
    <text x="18" y="58" font-family="Arial, Inter, sans-serif" font-size="12" fill="#334155">Edge-optimized response • caching rules • transforms</text>
  </g>

  <!-- End User -->
  <g transform="translate(720,340)">
    <rect width="240" height="100" fill="#e9f5ff" stroke="#222" stroke-width="1" rx="10" ry="10"/>
    <text x="18" y="34" font-family="Arial, Inter, sans-serif" font-size="18" font-weight="bold" fill="#0f172a">End User</text>
    <text x="18" y="58" font-family="Arial, Inter, sans-serif" font-size="12" fill="#334155">Browser or client requesting images</text>
  </g>

  <!-- Arrows (simple lines instead of markers) -->
  <line x1="300" y1="60" x2="380" y2="60" stroke="#94a3b8" stroke-width="2"/>
  <text x="330" y="50" font-family="Arial, Inter, sans-serif" font-size="13" font-weight="bold" fill="#0f172a">POST /upload</text>

  <line x1="640" y1="60" x2="720" y2="60" stroke="#94a3b8" stroke-width="2"/>
  <text x="650" y="50" font-family="Arial, Inter, sans-serif" font-size="13" font-weight="bold" fill="#0f172a">scan(image)</text>

  <line x1="500" y1="120" x2="500" y2="180" stroke="#94a3b8" stroke-width="2"/>
  <text x="420" y="150" font-family="Arial, Inter, sans-serif" font-size="13" font-weight="bold" fill="#0f172a">write object</text>

  <line x1="840" y1="120" x2="640" y2="240" stroke="#94a3b8" stroke-width="2"/>
  <text x="730" y="160" font-family="Arial, Inter, sans-serif" font-size="13" font-weight="bold" fill="#0f172a">approved → store</text>

  <line x1="420" y1="290" x2="200" y2="380" stroke="#94a3b8" stroke-width="2"/>
  <text x="300" y="340" font-family="Arial, Inter, sans-serif" font-size="13" font-weight="bold" fill="#0f172a">GET /image/:id</text>

  <line x1="560" y1="290" x2="720" y2="380" stroke="#94a3b8" stroke-width="2"/>
  <text x="620" y="340" font-family="Arial, Inter, sans-serif" font-size="13" font-weight="bold" fill="#0f172a">edge cache → client</text>

  <!-- Durable Objects interactions (dashed) -->
  <line x1="560" y1="80" x2="720" y2="130" stroke="#94a3b8" stroke-width="1.5" stroke-dasharray="6 6"/>
  <text x="580" y="100" font-family="Arial, Inter, sans-serif" font-size="12" fill="#334155">quota/check</text>

  <!-- Legend -->
  <g transform="translate(40,460)">
    <text x="0" y="14" font-family="Arial, Inter, sans-serif" font-size="13" font-weight="bold" fill="#0f172a">Legend</text>
    <rect x="0" y="22" width="12" height="12" fill="#e6f0ff" stroke="#222"/>
    <text x="20" y="32" font-family="Arial, Inter, sans-serif" font-size="12" fill="#334155">Frontend</text>
    <rect x="140" y="22" width="12" height="12" fill="#e9e7ff" stroke="#222"/>
    <text x="160" y="32" font-family="Arial, Inter, sans-serif" font-size="12" fill="#334155">Worker (compute)</text>
    <rect x="320" y="22" width="12" height="12" fill="#fff0d6" stroke="#222"/>
    <text x="340" y="32" font-family="Arial, Inter, sans-serif" font-size="12" fill="#334155">Storage</text>
    <rect x="520" y="22" width="12" height="12" fill="#e6fff5" stroke="#222"/>
    <text x="540" y="32" font-family="Arial, Inter, sans-serif" font-size="12" fill="#334155">Delivery</text>
  </g>
</svg>
